 // Check if the old password is equal to the new password
    if ($oldpassword === $newpassword) {
        echo '<script language="javascript">';
        echo 'alert("Old password and new password cannot be the same");';
        echo 'window.location = "change-password.php";';
        echo '</script>';
        exit; // Stop execution if passwords are the same
    }

    // Update the data in both tables
    $conn->beginTransaction();
    $newpassword = password_hash($password, PASSWORD_DEFAULT);

    try {
        $query2 = "
            UPDATE user
            SET password = :newpassword
            WHERE email = :email
        ";
        $statement2 = $conn->prepare($query2);
        $statement2->bindParam(':newpassword', $newpassword, PDO::PARAM_STR);
        $statement2->bindParam(':email', $email, PDO::PARAM_INT);
        if (!$statement2->execute()) {
            print_r($statement2->errorInfo());
            exit;
        }

        // If both updates are successful, commit the transaction
        $conn->commit();
        // $log = new AuditModelController();
        // $log->activity_log($currentUserId,"Change password","User has change password");
        echo '<script language="javascript">';
        echo 'alert("Password updated successfully");';
        echo 'window.location = "../function/logout.php";';
        echo '</script>';
    } catch (PDOException $e) {
        // An error occurred, rollback the transaction
        $conn->rollBack();
        echo "Error updating data: " . $e->getMessage();
    }
}

?>
